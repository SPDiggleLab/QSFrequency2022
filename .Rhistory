temp.truncDist = list()
for(gene in names(ls.refDist_by_gene)){
# Get Reference
ref_aminos = read.table(paste('INPUT/ref_genes/', gene, '_PAO1_protein.txt', sep='', collapse='')
, stringsAsFactors = F)$V1
ref_aminos = AAString(ref_aminos) # read in as biocstring object
# Calculate self-distance score
self_align = pairwiseAlignment(ref_aminos
, ref_aminos
, substitutionMatrix = "BLOSUM80"
, gapOpening=11
, gapExtension=1)@score
# normalize to self
v.dist = ls.refDist_by_gene[[gene]] / self_align
# get simple stats
mean_dist = mean(v.dist)
sd_dist = sd(v.dist)
df.truncations[gene, 'similarity_mean'] = mean_dist
df.truncations[gene, 'similarity_sd'] = sd_dist
# for plotting histogram
temp.truncDist[[gene]] = data.frame('gene' = gene, 'dist' = v.dist[v.dist!=1], 'same' = 0+(v.dist!=1))
}
temp.truncDist_df = do.call('rbind', temp.truncDist)
source('~/CYZ GITHUB/Digglets/For_Conan/visualize_data_overview.R')
source('~/CYZ GITHUB/Digglets/For_Conan/visualize_data_overview.R')
ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist)) + geom_boxplot() + scale_y_log10()
ggplot(temp.truncDist_df, aes(x = gene)) + geom_boxplot() + scale_y_log10()
ggplot(temp.truncDist_df, aes(x = gene, y = dist)) + geom_boxplot() + scale_y_log10()
ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist)) + geom_boxplot() + scale_y_log10()
fig1a3 = ggplot(df.truncations, aes(x = gene)) +
theme_gray(base_size = 14) +
geom_bar(color = 'grey30', stat='identity', alpha = 0.4, fill = 'grey10', aes(y = n_unique_strains)) +
geom_bar(color = 'black', stat='identity', alpha = 0.9, aes(y = n_unique_seqs, fill = sapply(df.truncations$gene, function(x){substr(x,1,3)}))) +
scale_fill_brewer(palette = 'Paired') +
theme(legend.title=element_blank()) +
ylab('n sequences') +
xlab('')
fig1a3
fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist)) +
theme_gray(base_size = 14) +
geom_boxplot()
ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist)) + geom_boxplot() + scale_y_log10()fig1a4
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist)) +
theme_gray(base_size = 14) +
geom_boxplot() +
scale_y_log10()
fig1a4
source('~/CYZ GITHUB/Digglets/For_Conan/visualize_data_overview.R')
fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist, fill = sapply(df.truncations$gene, function(x){substr(x,1,3)}))) +
theme_gray(base_size = 14) +
geom_boxplot() +
scale_y_log10() +
xlab('') +
ylab('dissimilarity')
fig1a4
temp.truncDist_df
fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist, fill = sapply(temp.truncDist_df$gene, function(x){substr(x,1,3)}))) +
theme_gray(base_size = 14) +
geom_boxplot() +
scale_y_log10() +
xlab('') +
ylab('dissimilarity')
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist, fill = sapply(temp.truncDist_df$gene, function(x){substr(x,1,3)}))) +
theme_gray(base_size = 14) +
geom_boxplot() +
scale_y_log10() +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist, fill = sapply(temp.truncDist_df$gene, function(x){substr(x,1,3)}))) +
theme_gray(base_size = 14) +
geom_boxplot() +
scale_y_log10() +
scale_fill_brewer(palette = 'Paired') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist, fill = sapply(temp.truncDist_df$gene, function(x){substr(x,1,3)}))) +
theme_gray(base_size = 14) +
geom_boxplot(size=2) +
scale_y_log10() +
scale_fill_brewer(palette = 'Paired') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist, fill = sapply(temp.truncDist_df$gene, function(x){substr(x,1,3)}))) +
theme_gray(base_size = 14) +
geom_boxplot(size=1) +
scale_y_log10() +
scale_fill_brewer(palette = 'Paired') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist, fill = sapply(temp.truncDist_df$gene, function(x){substr(x,1,3)}))) +
theme_gray(base_size = 14) +
geom_boxplot(size=0.8) +
scale_y_log10() +
scale_fill_brewer(palette = 'Paired') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist, fill = sapply(temp.truncDist_df$gene, function(x){substr(x,1,3)}))) +
theme_gray(base_size = 14) +
geom_boxplot() +
scale_y_log10() +
scale_fill_brewer(palette = 'Paired') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
fig1_full = plot_grid(fig1a3, fig1a4, fig1b, fig1c
, labels = c('A', 'B', 'C', 'D')
, nrow = 2
, rel_widths = c(1, 1.5, 1, 1.5))
fig1_full
require(cowplot)
fig1_full = plot_grid(fig1a3, fig1b, fig1a4, fig1c
, labels = c('A', 'B', 'C', 'D')
, nrow = 2
, rel_widths = c(1, 1, 1, 1))
fig1_full
fig1_full = plot_grid(fig1a3, fig1b, fig1a4, fig1c
, labels = c('A', 'B', 'C', 'D')
, nrow = 2
, rel_widths = c(1.5, 1.5, 1, 1))
fig1_full
require(cowplot)
fig1_full = plot_grid(fig1a3, fig1b, fig1a4, fig1c
, labels = c('A', 'B', 'C', 'D')
, nrow = 2
, rel_widths = c(1.5, 1, 1.5, 1))
fig1_full
require(cowplot)
fig1_full = plot_grid(fig1a3, fig1b, fig1a4, fig1c
, labels = c('A', 'B', 'C', 'D')
, nrow = 2
, rel_widths = c(2, 1, 2, 1))
fig1_full
fig2_full = plot_grid(fig2a, fig2b, labels = c('A', 'B')
, rel_widths = c(1, 2))
fig2_full
require(Biostrings)
library(Biostrings)
sessionInfo()
source('~/CYZ GITHUB/Digglets/For_Conan/visualize_data_overview.R')
source('~/CYZ GITHUB/Digglets/For_Conan/MASTER_IPCD-analysis.R')
fig1a
source('~/CYZ GITHUB/Digglets/For_Conan/visualize_data_overview.R')
fig1a
fig1a2
fig1a3
fig1a4
fig1b
fig1c
fig2a
df.truncations
fig1a3
fig1a4
temp.truncDist_df
ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist, fill = sapply(temp.truncDist_df$gene, function(x){substr(x,1,3)}))) +
theme_gray(base_size = 14) +
geom_boxplot() +
scale_y_log10() +
scale_fill_brewer(palette = 'Paired') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
ggplot(temp.truncDist_df, aes(x = gene, y = dist, fill = sapply(temp.truncDist_df$gene, function(x){substr(x,1,3)}))) +
theme_gray(base_size = 14) +
geom_boxplot() +
scale_y_log10() +
scale_fill_brewer(palette = 'Paired') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist, fill = sapply(temp.truncDist_df$gene, function(x){substr(x,1,3)}))) +
theme_gray(base_size = 14) +
geom_boxplot() +
scale_y_log10() +
scale_fill_brewer(palette = 'Paired') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = log(1-dist), fill = sapply(temp.truncDist_df$gene, function(x){substr(x,1,3)}))) +
theme_gray(base_size = 14) +
geom_boxplot() +
#scale_y_log10() +
scale_fill_brewer(palette = 'Paired') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = log(1-dist), fill = sapply(temp.truncDist_df$gene, function(x){substr(x,1,3)}))) +
theme_gray(base_size = 14) +
geom_boxplot() +
#scale_y_log10() +
scale_fill_brewer(palette = 'Paired') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist, fill = sapply(temp.truncDist_df$gene, function(x){substr(x,1,3)}))) +
theme_gray(base_size = 14) +
geom_boxplot() +
#scale_y_log10() +
scale_fill_brewer(palette = 'Paired') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
head(temp.truncDist_df)
sum(temp.truncDist_df$same)
fig1a4 = ggplot(temp.truncDist_df[temp.trunc_df$same!= 1,], aes(x = gene, y = 1-dist, fill = sapply(temp.truncDist_df$gene, function(x){substr(x,1,3)}))) +
theme_gray(base_size = 14) +
geom_boxplot() +
#scale_y_log10() +
scale_fill_brewer(palette = 'Paired') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
fig1a4 = ggplot(temp.truncDist_df[temp.truncDist_df$same!= 1,], aes(x = gene, y = 1-dist, fill = sapply(temp.truncDist_df$gene, function(x){substr(x,1,3)}))) +
theme_gray(base_size = 14) +
geom_boxplot() +
#scale_y_log10() +
scale_fill_brewer(palette = 'Paired') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
temp.truncDist_df[temp.truncDist_df$same!= 1,]
head(temp.truncDist_df[temp.truncDist_df$same!= 1,])
head(temp.truncDist_df[temp.truncDist_df$dist != 1,])
fig1a4 = ggplot(temp.truncDist_df[temp.truncDist_df$dist != 1,], aes(x = gene, y = 1-dist, fill = sapply(temp.truncDist_df$gene, function(x){substr(x,1,3)}))) +
theme_gray(base_size = 14) +
geom_boxplot() +
#scale_y_log10() +
scale_fill_brewer(palette = 'Paired') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
sapply(temp.truncDist_df$gene, function(x){substr(x,1,3)})
temp.truncDist_df$sys = sapply(temp.truncDist_df$gene, function(x){substr(x,1,3)})
head(temp.truncDist_df)
fig1a4 = ggplot(temp.truncDist_df[temp.truncDist_df$dist != 1,], aes(x = gene, y = 1-dist, fill = sys)) +
theme_gray(base_size = 14) +
geom_boxplot() +
#scale_y_log10() +
scale_fill_brewer(palette = 'Paired') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
fig1a4 = ggplot(temp.truncDist_df[temp.truncDist_df$dist != 1,], aes(x = gene, y = 1-dist, fill = sys)) +
theme_gray(base_size = 14) +
geom_boxplot() +
scale_y_log10() +
scale_fill_brewer(palette = 'Paired') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
fig1a4 = ggplot(temp.truncDist_df[temp.truncDist_df$dist != 1,], aes(x = gene, y = dist, fill = sys)) +
theme_gray(base_size = 14) +
geom_boxplot() +
scale_y_log10() +
scale_fill_brewer(palette = 'Paired') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
source('~/CYZ GITHUB/Digglets/For_Conan/visualize_data_overview.R')
fig1a4 = ggplot(temp.truncDist_df[temp.truncDist_df$dist != 1,], aes(x = gene, y = 1-dist, fill = sys)) +
theme_gray(base_size = 14) +
geom_boxplot() +
scale_y_log10() +
scale_fill_brewer(palette = 'Paired') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4 = ggplot(temp.truncDist_df[temp.truncDist_df$dist != 1,], aes(x = gene, y = 1-dist, fill = sys)) +
theme_gray(base_size = 14) +
geom_boxplot() +
scale_y_log10() +
scale_fill_brewer(palette = 'Paired') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
test = temp.truncDist_df[temp.truncDist_df$gene == 'lasR',]
test
test = temp.truncDist_df[temp.truncDist_df$gene == 'lasR',]
test
geom_hist(test$dist)
hist(test$dist)
temp.truncDist[[gene]]
self_alaign
self_align
hist(test$dist[test$dist!=1])
self_align
head(df.truncations)
ref_aminos
v.dist
df.truncations
df.lasR_meta
head(df.lasR_meta)
temp.truncDist[[1]]
test
ls.complete_gene_MetaSeq[[1]]
head(df.lasR_meta)
head(df.lasR_meta$SEQUENCE)
nchar(df.lasR_meta$SEQUENCE)
hist(nchar(df.lasR_meta$SEQUENCE))
table(nchar(df.lasR_meta$SEQUENCE)
)
fig1a4 = ggplot(temp.truncDist_df[temp.truncDist_df$dist != 1,], aes(x = gene, y = 1-dist, fill = sys)) +
theme_gray(base_size = 14) +
geom_boxplot() +
scale_y_log10() +
scale_fill_brewer(palette = 'Paired') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
test2 = temp.truncDist_df[temp.truncDist_df$dist != 1,]
fig1a4 = ggplot(test2, aes(x = gene, y = 1-dist, fill = sys, color = sys)) +
theme_gray(base_size = 14) +
geom_boxplot() +
#scale_y_log10() +
scale_fill_brewer(palette = 'Paired') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
fig1a4 = ggplot(test2, aes(x = gene, y = 1-dist, fill = sys, color = sys)) +
theme_gray(base_size = 14) +
geom_boxplot() +
#scale_y_log10() +
scale_fill_brewer(palette = 'Paired') +
scale_color_brewer(palette = 'Paired')
fig1a4 = ggplot(test2, aes(x = gene, y = 1-dist, fill = sys, color = sys)) +
theme_gray(base_size = 14) +
geom_boxplot() +
#scale_y_log10() +
scale_fill_brewer(palette = 'Paired') +
scale_color_brewer(palette = 'Paired') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
fig1a4 = ggplot(test2, aes(x = gene, y = 1-dist, fill = sys, color = sys)) +
theme_gray(base_size = 14) +
geom_boxplot() +
#scale_y_log10() +
scale_fill_brewer(palette = 'Set3') +
scale_color_brewer(palette = 'Set3') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
fig1a4 = ggplot(test2, aes(x = gene, y = 1-dist, fill = sys, color = sys)) +
theme_gray(base_size = 14) +
geom_boxplot() +
#scale_y_log10() +
scale_fill_brewer(palette = 'Set2') +
scale_color_brewer(palette = 'Set2') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
fig1a4 = ggplot(test2, aes(x = gene, y = 1-dist, fill = sys, color = sys)) +
theme_gray(base_size = 14) +
geom_boxplot() +
#scale_y_log10() +
scale_fill_brewer(palette = 'Set1') +
scale_color_brewer(palette = 'Set1') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
test2 = temp.truncDist_df#[temp.truncDist_df$dist != 1,]
fig1a4 = ggplot(test2, aes(x = gene, y = 1-dist, fill = sys, color = sys)) +
theme_gray(base_size = 14) +
geom_boxplot() +
#scale_y_log10() +
scale_fill_brewer(palette = 'Set1') +
scale_color_brewer(palette = 'Set1') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
fig1a4 = ggplot(test2, aes(x = gene, y = 1-dist, fill = sys, color = sys)) +
theme_gray(base_size = 14) +
geom_density() +
#geom_boxplot() +
#scale_y_log10() +
scale_fill_brewer(palette = 'Set1') +
scale_color_brewer(palette = 'Set1') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
test2 = temp.truncDist_df[temp.truncDist_df$dist != 1,]
fig1a4 = ggplot(test2, aes(x = gene, y = 1-dist, fill = sys, color = sys)) +
theme_gray(base_size = 14) +
geom_boxplot() +
#scale_y_log10() +
scale_fill_brewer(palette = 'Set1') +
scale_color_brewer(palette = 'Set1') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
fig1a4 = ggplot(test2, aes(x = gene, y = 1-dist, fill = sys, color = sys)) +
theme_gray(base_size = 14) +
geom_boxplot() +
scale_y_log10() +
scale_fill_brewer(palette = 'Set1') +
scale_color_brewer(palette = 'Set1') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
fig1a4 = ggplot(test2, aes(x = gene, y = 1-dist, fill = sys, color = sys)) +
theme_gray(base_size = 14) +
geom_boxplot() +
scale_y_log10() +
scale_fill_brewer(palette = 'Set1') +
#scale_color_brewer(palette = 'Set1') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
fig1a4 = ggplot(test2, aes(x = gene, y = 1-dist, fill = sys)#, color = sys)) +
theme_gray(base_size = 14) +
geom_boxplot() +
scale_y_log10() +
scale_fill_brewer(palette = 'Set1') +
scale_color_brewer(palette = 'Set1') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4 = ggplot(test2, aes(x = gene, y = 1-dist, fill = sys))+#, color = sys)) +
theme_gray(base_size = 14) +
geom_boxplot() +
scale_y_log10() +
scale_fill_brewer(palette = 'Set1') +
scale_color_brewer(palette = 'Set1') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
fig1a4 = ggplot(test2, aes(x = gene, y = 1-dist, color = sys))+#, color = sys)) +
theme_gray(base_size = 14) +
geom_boxplot() +
scale_y_log10() +
scale_fill_brewer(palette = 'Set1') +
scale_color_brewer(palette = 'Set1') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
fig1c = ls.pcas[['lasI']] +
theme_gray(base_size = 14)  +
geom_point(color = 'black', size = 3) +
theme(legend.position = 'none') +
ggtitle('')
source('~/CYZ GITHUB/Digglets/For_Conan/visualize_data_overview.R')
fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist, fill = sapply(temp.truncDist_df$gene, function(x){substr(x,1,3)}))) +
theme_gray(base_size = 14) +
geom_boxplot() +
#scale_y_log10() +
scale_fill_brewer(palette = 'Paired') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist, fill = sapply(temp.truncDist_df$gene, function(x){substr(x,1,3)}))) +
theme_gray(base_size = 14) +
geom_boxplot() +
geom_point() +
#scale_y_log10() +
scale_fill_brewer(palette = 'Paired') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
source('~/CYZ GITHUB/Digglets/For_Conan/visualize_data_overview.R')
fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist, fill = sys)) +
theme_gray(base_size = 14) +
geom_boxplot() +
geom_point() +
#scale_y_log10() +
scale_fill_brewer(palette = 'Paired') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
ggplot(temp.truncDist_df, aes(x = 1-dist)) + geom_density() + facet_wrap('gene')
ggplot(temp.truncDist_df, aes(x = 1-dist)) + geom_density() + facet_wrap('gene') + scale_x_log10()
ggplot(temp.truncDist_df, aes(x = 1-dist, color = gene)) + geom_density() + scale_x_log10()
ggplot(temp.truncDist_df, aes(x = 1-dist, color = gene)) + geom_density() + scale_x_log10() + facet_wrap('sys')
ggplot(temp.truncDist_df, aes(x = 1-dist, color = gene)) + geom_density() + scale_x_log10() + facet_wrap('sys', ncol=1)
ggplot(temp.truncDist_df, aes(x = 1-dist, color = gene, fill = sys)) + geom_density() + scale_x_log10() + facet_wrap('sys', ncol=1)
fig1a4
