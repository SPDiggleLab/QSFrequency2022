fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist, fill = sys, color = gene)) +
theme_gray(base_size = 14) +
geom_jitter(alpha = 0.7) +
#scale_color_brewer(palette = 'Set1') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
coord_flip()
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist, fill = sys, color = gene)) +
theme_gray(base_size = 14) +
geom_point(alpha=0.7) +
#geom_jitter(alpha = 0.7) +
#scale_color_brewer(palette = 'Set1') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
coord_flip()
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = 1-dist, fill = sys, color = gene)) +
theme_gray(base_size = 14) +
geom_density() +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
coord_flip()
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = 1-dist, fill = sys, color = gene)) +
theme_gray(base_size = 14) +
geom_density() +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
facet_grid(gene>~)
fig1a4 = ggplot(temp.truncDist_df, aes(x = 1-dist, fill = sys, color = gene)) +
theme_gray(base_size = 14) +
geom_density() +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
facet_grid(gene~.)
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = 1-dist, fill = sys, color = gene)) +
theme_gray(base_size = 14) +
geom_density() +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
facet_grid(gene~., scales = 'free')
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = 1-dist, fill = sys, color = gene)) +
theme_gray(base_size = 14) +
geom_density() +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
scale_fill_brewer(palette = 'Paired')
facet_grid(gene~., scales = 'free')
fig1a4 = ggplot(temp.truncDist_df, aes(x = 1-dist, fill = sys, color = gene)) +
theme_gray(base_size = 14) +
geom_density() +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
scale_fill_brewer(palette = 'Paired')
facet_grid(gene~., scales = 'free')
fig1a4 = ggplot(temp.truncDist_df, aes(x = 1-dist, fill = sys, color = gene)) +
theme_gray(base_size = 14) +
geom_density() +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
scale_fill_brewer(palette = 'Paired') +
facet_grid(gene~., scales = 'free')
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist, fill = sys)) +
theme_gray(base_size = 14) +
geom_point(alpha=0.7) +
#geom_jitter(alpha = 0.7) +
#scale_color_brewer(palette = 'Set1') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
coord_flip()
fig1a4 = ggplot(temp.truncDist_df, aes(x = 1-dist, fill = sys, color = gene)) +
theme_gray(base_size = 14) +
geom_density() +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
scale_fill_brewer(palette = 'Paired') +
facet_grid(gene~., scales = 'free')
fig1a4 = ggplot(temp.truncDist_df, aes(x = 1-dist, fill = sys, color = gene)) +
theme_gray(base_size = 14) +
geom_density() +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
scale_fill_brewer(palette = 'Paired') +
facet_grid(gene~., scales = 'free')
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = 1-dist, fill = sys, color = gene)) +
theme_gray(base_size = 14) +
geom_density() +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
scale_fill_brewer(palette = 'Paired') +
scale_x_log10()
fig1a4 = ggplot(temp.truncDist_df, aes(x = 1-dist, fill = sys, color = gene)) +
theme_gray(base_size = 14) +
geom_density() +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
scale_fill_brewer(palette = 'Paired') +
scale_x_log10() +
facet_grid(gene~., scales = 'free')
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = 1-dist, fill = sys, color = gene)) +
theme_gray(base_size = 14) +
geom_density() +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
scale_fill_brewer(palette = 'Paired') +
scale_x_log10() +
facet_grid(gene~.)
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = 1-dist, fill = sys)) +
theme_gray(base_size = 14) +
geom_density() +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
scale_fill_brewer(palette = 'Paired') +
scale_x_log10() +
facet_grid(gene~.)
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = 1-dist, fill = sys)) +
theme_gray(base_size = 14) +
geom_density() +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
scale_fill_brewer(palette = 'Paired') +
scale_x_log10() +
facet_grid(gene~., shrink = T)
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = 1-dist, fill = sys)) +
theme_gray(base_size = 14) +
geom_density() +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
scale_fill_brewer(palette = 'Paired') +
scale_x_log10() +
facet_grid(gene~., space = 'free_y')
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = 1-dist, fill = sys)) +
theme_gray(base_size = 14) +
geom_density() +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
scale_fill_brewer(palette = 'Paired') +
scale_x_log10() +
facet_grid(gene~., space = 'free')
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = 1-dist, fill = sys)) +
theme_gray(base_size = 14) +
geom_density() +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
scale_fill_brewer(palette = 'Paired') +
scale_x_log10() +
facet_grid(gene~., scale = 'free', space = 'free')
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = 1-dist, color = gene)) +
theme_gray(base_size = 14) +
geom_density() +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
scale_fill_brewer(palette = 'Paired') +
scale_x_log10()
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = 1-dist, color = gene)) +
theme_gray(base_size = 14) +
geom_density() +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
scale_fill_brewer(palette = 'Paired') +
scale_x_log10() +
facet_grid(sys~., scale = 'free', space = 'free')
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = 1-dist, color = gene)) +
theme_gray(base_size = 14) +
geom_density() +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
scale_fill_brewer(palette = 'Paired') +
facet_grid(sys~., scale = 'free', space = 'free')
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = 1-dist, color = gene)) +
theme_gray(base_size = 14) +
geom_density() +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
scale_fill_brewer(palette = 'Paired') +
scale_y_log10() +
facet_grid(sys~., scale = 'free', space = 'free')
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = 1-dist, color = gene)) +
theme_gray(base_size = 14) +
geom_density() +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
scale_fill_brewer(palette = 'Paired') +
scale_x_log10() +
facet_grid(sys~., scale = 'free', space = 'free')
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = 1-dist, color = gene)) +
theme_gray(base_size = 14) +
stat_ecdf() +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
scale_fill_brewer(palette = 'Paired') +
scale_x_log10() +
facet_grid(sys~., scale = 'free', space = 'free')
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = 1-dist, color = gene)) +
theme_gray(base_size = 14) +
stat_ecdf() +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
scale_fill_brewer(palette = 'Paired') +
scale_x_log10() +
facet_grid(gene~., scale = 'free', space = 'free')
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = 1-dist, color = gene)) +
theme_gray(base_size = 14) +
stat_ecdf() +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
scale_fill_brewer(palette = 'Paired') +
facet_grid(gene~., scale = 'free', space = 'free')
fig1a4
fig1a4
fig1b = ls.pcas[['lasR']] +
theme_gray(base_size = 14) +
geom_point(color = 'black', size = 3) +
theme(legend.position = 'none') +
ggtitle('')
fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist, fill = sys)) +
theme_gray(base_size = 14) +
geom_point(alpha=0.7) +
#geom_jitter(alpha = 0.7) +
#scale_color_brewer(palette = 'Set1') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
coord_flip()
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist, fill = sys)) +
theme_gray(base_size = 14) +
geom_point(alpha=0.7) +
geom_jitter(alpha = 0.7) +
scale_color_brewer(palette = 'Set1') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
coord_flip()
fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist, fill = sys)) +
theme_gray(base_size = 14) +
#geom_point(alpha=0.7) +
geom_jitter(alpha = 0.7) +
scale_color_brewer(palette = 'Set1') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
coord_flip()
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist, color = sys)) +
theme_gray(base_size = 14) +
#geom_point(alpha=0.7) +
geom_jitter(alpha = 0.7) +
scale_color_brewer(palette = 'Set1') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
coord_flip()
fig1a4
# PLOT --------------------------------------------------------------------
fig1a = ggplot(df.truncations, aes(x = gene, y = similarity_mean)) +
theme_gray(base_size = 14) +
geom_bar(stat = 'identity', color = 'black') +
geom_errorbar(size =2, aes(ymin = similarity_mean-similarity_sd
, ymax = similarity_mean+similarity_sd)
, width = .5) +
ylim(c(0, 1.2)) +
xlab('') +
ylab('Normalized Similarity Score') +
scale_fill_brewer(palette = 'Set1') +
theme(legend.position = 'none'
, axis.text.x = element_text(angle = 45, hjust=1, vjust=1))
fig1a2 = ggplot(df.truncations, aes(x = n_base, y = similarity_mean)) +
theme_gray(base_size=14) +
geom_point(size=2) +
geom_text(aes(label = ifelse(similarity_mean<0.993, gene, ''))
, hjust=-0.3, vjust=0) +
ylab('Normalized Similarity Score') +
xlim(600, 1600)
fig1a3 = ggplot(df.truncations, aes(x = gene)) +
theme_gray(base_size = 14) +
geom_bar(color = 'grey30', stat='identity', alpha = 0.4, fill = 'grey10', aes(y = n_unique_strains)) +
geom_bar(color = 'black', stat='identity', alpha = 0.9, aes(y = n_unique_seqs, fill = sapply(df.truncations$gene, function(x){substr(x,1,3)}))) +
scale_fill_brewer(palette = 'Paired') +
theme(legend.title=element_blank()) +
ylab('n sequences') +
xlab('')
fig1a3
fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist, color = sys)) +
theme_gray(base_size = 14) +
#geom_point(alpha=0.7) +
geom_jitter(alpha = 0.7) +
scale_color_brewer(palette = 'Set1') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
coord_flip()
fig1a4
fig1b = ls.pcas[['lasR']] +
theme_gray(base_size = 14) +
geom_point(color = 'black', size = 3) +
theme(legend.position = 'none') +
ggtitle('')
fig1c = ls.pcas[['lasI']] +
theme_gray(base_size = 14)  +
geom_point(color = 'black', size = 3) +
theme(legend.position = 'none') +
ggtitle('')
fig2a = ggplot(df.lasR_meta, aes(x = GROUP, fill = TRUNCATED)) +
geom_bar(stat = 'count', color = 'black') +
xlab('')
fig2b = ls.pcas[['lasR']]
fig1_full = plot_grid(fig1a3, fig1b, fig1a4, fig1c
, labels = c('A', 'C', 'B', 'D')
, nrow = 2
, rel_widths = c(1.5, 1, 1.5, 1))
fig1_full
fig2_full = plot_grid(fig2a, fig2b, labels = c('A', 'B')
, rel_widths = c(1, 2))
fig2_full
fig1_full
# PLOT --------------------------------------------------------------------
fig1a = ggplot(df.truncations, aes(x = gene, y = similarity_mean)) +
theme_gray(base_size = 14) +
geom_bar(stat = 'identity', color = 'black') +
geom_errorbar(size =2, aes(ymin = similarity_mean-similarity_sd
, ymax = similarity_mean+similarity_sd)
, width = .5) +
ylim(c(0, 1.2)) +
xlab('') +
ylab('Normalized Similarity Score') +
scale_fill_brewer(palette = 'Set1') +
theme(legend.position = 'none'
, axis.text.x = element_text(angle = 45, hjust=1, vjust=1))
fig1a = ggplot(df.truncations, aes(x = gene, y = similarity_mean)) +
theme_gray(base_size = 14) +
geom_bar(stat = 'identity', color = 'black') +
geom_errorbar(size =2, aes(ymin = similarity_mean-similarity_sd
, ymax = similarity_mean+similarity_sd)
, width = .5) +
ylim(c(0, 1.2)) +
xlab('') +
ylab('Normalized Similarity Score') +
scale_fill_brewer(palette = 'Set1') +
theme(legend.position = 'none'
, axis.text.x = element_text(angle = 45, hjust=1, vjust=1))
fig1a2 = ggplot(df.truncations, aes(x = n_base, y = similarity_mean)) +
theme_gray(base_size=14) +
geom_point(size=2) +
geom_text(aes(label = ifelse(similarity_mean<0.993, gene, ''))
, hjust=-0.3, vjust=0) +
ylab('Normalized Similarity Score') +
xlim(600, 1600)
fig1a3 = ggplot(df.truncations, aes(x = gene)) +
theme_gray(base_size = 14) +
geom_bar(color = 'grey30', stat='identity', alpha = 0.4, fill = 'grey10', aes(y = n_unique_strains)) +
geom_bar(color = 'black', stat='identity', alpha = 0.9, aes(y = n_unique_seqs, fill = sapply(df.truncations$gene, function(x){substr(x,1,3)}))) +
scale_fill_brewer(palette = 'Set1') +
theme(legend.title=element_blank()) +
ylab('n sequences') +
xlab('')
fig1a3
fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist, color = sys)) +
theme_gray(base_size = 14) +
#geom_point(alpha=0.7) +
geom_jitter(alpha = 0.7) +
scale_color_brewer(palette = 'Set1') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
coord_flip()
fig1a4
fig1b = ls.pcas[['lasR']] +
theme_gray(base_size = 14) +
geom_point(color = 'black', size = 3) +
theme(legend.position = 'none') +
ggtitle('')
fig1c = ls.pcas[['lasI']] +
theme_gray(base_size = 14)  +
geom_point(color = 'black', size = 3) +
theme(legend.position = 'none') +
ggtitle('')
fig2a = ggplot(df.lasR_meta, aes(x = GROUP, fill = TRUNCATED)) +
geom_bar(stat = 'count', color = 'black') +
xlab('')
fig2b = ls.pcas[['lasR']]
fig1_full = plot_grid(fig1a3, fig1b, fig1a4, fig1c
, labels = c('A', 'C', 'B', 'D')
, nrow = 2
, rel_widths = c(1.5, 1, 1.5, 1))
fig1_full
fig1_full
fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist, color = sys)) +
theme_gray(base_size = 14) +
#geom_point(alpha=0.7) +
geom_jitter(alpha = 0.7) +
scale_color_brewer(palette = 'Set1') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity')
fig1a4
fig1_full
fig1_full = plot_grid(fig1a3, fig1b, fig1a4, fig1c
, labels = c('A', 'C', 'B', 'D')
, nrow = 2
, rel_widths = c(1.5, 1, 1.5, 1))
fig1_full
ggsave('2020-11-02_fig1-full.png', fig1_full, device = 'png', width = 8, height = 6)
ggsave('2020-11-02_fig1-full.png', fig1_full, device = 'png', width = 10, height = )
ggsave('2020-11-02_fig1-full.png', fig1_full, device = 'png', width = 10, height = 8)
ggsave('2020-11-02_fig1-full.png', fig1_full, device = 'png', width = 12, height = 8)
fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist, color = sys)) +
theme_gray(base_size = 14) +
#geom_point(alpha=0.7) +
geom_jitter(alpha = 0.7) +
scale_color_brewer(palette = 'Set1') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
facet_grid(.~gene)
fig1a4
fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist, color = sys)) +
theme_gray(base_size = 14) +
#geom_point(alpha=0.7) +
geom_jitter(alpha = 0.7) +
scale_color_brewer(palette = 'Set1') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
facet_grid(.~gene, scale = 'free_x')
fig1a4
fig1a4
fig1_full
fig1_full = plot_grid(fig1a3, fig1b, fig1a4, fig1c
, labels = c('A', 'C', 'B', 'D')
, nrow = 2
, rel_widths = c(1.5, 1, 1.5, 1))
fig1_full
ggsave('2020-11-02_fig1-full.png', fig1_full, device = 'png', width = 12, height = 8)
fig1a3 = ggplot(df.truncations, aes(x = gene)) +
theme_gray(base_size = 14) +
geom_bar(color = 'grey30', stat='identity', alpha = 0.4, fill = 'grey10', aes(y = n_unique_strains)) +
geom_bar(color = 'black', stat='identity', alpha = 0.9, aes(y = n_unique_seqs, fill = sapply(df.truncations$gene, function(x){substr(x,1,3)}))) +
scale_fill_brewer(palette = 'Set1') +
theme(legend.title=element_blank()) +
ylab('n sequences') +
xlab('') +
theme(legend.position = 'none')
fig1a3
fig1a4 = ggplot(temp.truncDist_df, aes(x = gene, y = 1-dist, color = sys)) +
theme_gray(base_size = 14) +
#geom_point(alpha=0.7) +
geom_jitter(alpha = 0.7) +
scale_color_brewer(palette = 'Set1') +
theme(legend.title=element_blank()) +
xlab('') +
ylab('dissimilarity') +
facet_grid(.~gene, scale = 'free_x') +
theme(legend.position = 'none')
fig1a4
fig1_full = plot_grid(fig1a3, fig1b, fig1a4, fig1c
, labels = c('A', 'C', 'B', 'D')
, nrow = 2
, rel_widths = c(1.5, 1, 1.5, 1))
fig1_full
ggsave('2020-11-02_fig1-full.png', fig1_full, device = 'png', width = 11, height = 8)
ggsave('2020-11-02_fig2-full.png', fig2_full, device = 'png', width = 6, height = 6)
ggsave('2020-11-02_fig2-full.png', fig2_full, device = 'png', width = 11, height = 8)
ggsave('2020-11-02_fig2-full.png', fig2_full, device = 'png', width = 8, height = 5)
ggsave('2020-11-02_fig2-full.png', fig2_full, device = 'png', width = 9, height = 5)
